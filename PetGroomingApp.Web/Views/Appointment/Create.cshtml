@model PetGroomingApp.Web.ViewModels.Appointment.AppointmentFormViewModel

@{
    ViewData["Title"] = "Book Appointment";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<partial name="_PageTitle" />

<section class="appointment_area">
    <div class="container mt-5">
        <form id="appointmentForm" asp-action="Create" method="post" class="bg-light p-4 rounded-4 shadow-sm border">

            <!-- Date & Time Picker -->
            <div class="mb-3">
                <label for="appointmentDateTime" class="form-label">Date & Time</label>
                <input type="datetime-local" id="appointmentDateTime" name="AppointmentTime" class="form-control"
                       min="@DateTime.Now.AddDays(1).ToString("yyyy-MM-ddTHH:mm")"
                       max="@DateTime.Now.AddMonths(1).ToString("yyyy-MM-ddTHH:mm")" required />
                <span asp-validation-for="AppointmentTime" class="text-danger"></span>
            </div>

            <!-- Groomer Dropdown (SelectListItem) -->
            <div class="mb-3">
                <label for="groomerDropdown" class="form-label">Groomer</label>
                <select id="groomerDropdown" asp-for="SelectedGroomerId" asp-items="Model.Groomers" class="form-select" required>
                    <option value="">Select a groomer</option>
                </select>
                <span asp-validation-for="SelectedGroomerId" class="text-danger"></span>
            </div>

            <!-- Pet Dropdown (SelectListItem) -->
            <div class="mb-3">
                <label for="petDropdown" class="form-label">Pet</label>
                <select id="petDropdown" asp-for="SelectedPetId" asp-items="Model.Pets" class="form-select" required>
                    <option value="">Select a pet</option>
                </select>
                <span asp-validation-for="SelectedPetId" class="text-danger"></span>
            </div>

            <!-- Service Checkboxes (ViewModel) -->
            <div class="mb-3">
                <label class="form-label">Services</label>
                <div id="servicesCheckboxes">
                    @if (Model.Services != null)
                    {
                        foreach (var service in Model.Services)
                        {
                            <div class="form-check">
                                <input class="form-check-input service-checkbox"
                                       type="checkbox"
                                       name="SelectedServiceIds"
                                       id="service_@service.Id"
                                       value="@service.Id"
                                       data-duration="@service.Duration"
                                       data-price="@service.Price" />
                                <label class="form-check-label" for="service_@service.Id">
                                    @service.Name (@service.Duration min, $@service.Price)
                                </label>
                            </div>
                        }
                    }
                </div>
                <span asp-validation-for="SelectedServiceIds" class="text-danger"></span>
            </div>

            <!-- Totals -->
            <div class="mb-3">
                <strong>Total Duration:</strong> <span id="totalDuration">0</span> min<br />
                <strong>Total Price:</strong> $<span id="totalPrice">0.00</span>
            </div>

            <button type="submit" class="btn btn-success">Book Appointment</button>
        </form>
    </div>
</section>

@section Scripts {
    <script src="~/js/appointment-booking.js"></script>
    <partial name="_ValidationScriptsPartial" />
}